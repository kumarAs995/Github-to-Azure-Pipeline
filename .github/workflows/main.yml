pool:
  vmImage: 'windows-latest'

steps:
- script: |
    powershell.exe -NoProfile -InputFormat None -ExecutionPolicy AllSigned -Command "[System.Net.ServicePointManager]::SecurityProtocol = 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://dl-cli.pstmn.io/install/win64.ps1'))"
  displayName: 'Install Postman CLI'

- task: CmdLine@2
  displayName: 'Run automated API tests using Postman CLI'
  inputs:
    script: |
        postman login --with-api-key $(POSTMAN_API_KEY)
        # Run your collection using Postman CLI
        postman collection run "43249942-261bb3ce-117b-4455-9e03-96d8fb7a13e4" -e "43249942-0e03d75f-5b1a-4073-87a0-bfb99b9c9a76"
        postman collection run "43249942-261bb3ce-117b-4455-9e03-96d8fb7a13e4" -e "43249942-116ba40e-408f-4804-a47f-a356662ccb60"
